vars:
  BUILD_DIR: "./builds"

tasks:
  build-all:
    desc: "build binaries for all"
    cmds:
      - echo "done!"
    deps:
      - build-linux-amd64
      - build-macos-amd64
      - build-macos-arm64
      - build-windows-amd64

  build-linux-amd64:
    desc: "build binary for linux amd64"
    cmds:
      - GOOS=linux GOARCH=amd64 go build -o {{.BUILD_DIR}}/wrkit.linux.amd64
      - echo "success build for linux amd64!"
    deps:
      - make-builds-dir
    parallel: true

  build-macos-amd64:
    desc: "build binary for macos amd64"
    cmds:
      - GOOS=darwin GOARCH=amd64 go build -o {{.BUILD_DIR}}/wrkit.macos.amd64
      - echo "success build for macos amd64!"
    deps:
      - make-builds-dir
    parallel: true

  build-macos-arm64:
    desc: "build binary for macos arm64"
    cmds:
      - GOOS=darwin GOARCH=arm64 go build -o {{.BUILD_DIR}}/wrkit.macos.arm64
      - echo "success build for macos arm64!"
    deps:
      - make-builds-dir
    parallel: true

  build-windows-amd64:
    desc: "build binary for windows amd64"
    cmds:
      - GOOS=windows GOARCH=amd64 go build -o {{.BUILD_DIR}}/wrkit.windows.amd64.exe
      - echo "success build for windows amd64!"
    deps:
      - make-builds-dir
    parallel: true

  make-builds-dir:
    desc: "make directory for builds"
    cmds: |
      mkdir -p {{.BUILD_DIR}}
